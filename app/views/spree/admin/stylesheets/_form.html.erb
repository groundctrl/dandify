<% content_for :head do %>
  <%= javascript_include_tag 'https://cdnjs.cloudflare.com/ajax/libs/ace/1.2.0/ace.js' %>
  <%= javascript_include_tag 'https://cdnjs.cloudflare.com/ajax/libs/ace/1.2.0/mode-css.js' %>
<% end %>

<div data-hook="admin_style_form_fields" class="col-md-12">
  <div class="form-group 12-row">
    <div data-hook="admin_stylesheet_form_style_raw" class="form-group field spree-ace-field">
      <div id="editor"></div>
      <%= f.field_container :style_raw, class: ['form-group'] do %>
        <%= f.label :style_raw, Spree.t('dandify.admin.labels.style_raw') %>
        <%= f.text_area :style_raw, rows: '13', class: 'form-control' %>
        <br/><span class="help-block"><%= Spree.t('dandify.admin.notes.sass') %></span>
      <% end %>
    </div>
  </div>
</div>

<script>
  (function() {
    var cssEditor, stylesheetText = $("#stylesheet_style_raw");

    $(function() {
      cssEditor = ace.edit("editor");
      cssEditor.getSession().setMode("ace/mode/css");
      cssEditor.setValue(stylesheetText.text());
    });

    $('#new_stylesheet, .edit_stylesheet').submit(function(event) {
      stylesheetText.text(cssEditor.getValue());
    });
  })();
</script>
